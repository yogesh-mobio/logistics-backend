<%- contentFor('HeaderCss') %> <%- contentFor('breadcrumb') %>
<ul class="list-inline menu-left mb-0">
  <li class="list-inline-item">
    <button type="button" class="button-menu-mobile open-left waves-effect">
      <i class="ion-navicon"></i>
    </button>
  </li>
  <li class="hide-phone list-inline-item app-search">
    <h3 class="page-title">Add Vehicle</h3>
  </li>
</ul>

<%- contentFor('body') %>
<div class="page-content-wrapper">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12">
        <div class="card m-b-20">
          <div class="card-body">
            <h4 class="mt-0 header-title">Add a new vehicle to the system.</h4>
            <br /><br />
            <% include ../Partials/errorMessages %>
            <form
              method="POST"
              class="form-horizontal"
              enctype="multipart/form-data"
            >
              <div class="form-group row">
                <label for="vehicleName" class="col-sm-2 col-form-label"
                  >Vehicle Name</label
                >
                <div class="col-sm-10">
                  <input
                    class="form-control"
                    type="text"
                    id="vehicleName"
                    name="name"
                    placeholder="Enter your Name of the Vehicle"
                    value="TATA"
                  />
                </div>
              </div>

              <div class="form-group row">
                <label for="vehicleCapacity" class="col-sm-2 col-form-label"
                  >Capacity</label
                >
                <div class="col-sm-10">
                  <input
                    class="form-control"
                    type="text"
                    id="vehicleCapacity"
                    name="capacity"
                    placeholder="Enter the capacity of the vehicle"
                    value="1100"
                  />
                  <div>
                    <small class="form-text text-muted"
                      >Please enter capacity in tons.</small
                    >
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <label class="col-sm-2 col-form-label">Dimensions</label>
                <div class="col-sm-10">
                  <div
                    class="input-group bootstrap-touchspin bootstrap-touchspin-injected"
                  >
                    <span
                      class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                      ><span class="input-group-text">Length</span></span
                    >
                    <input
                      class="form-control"
                      type="text"
                      id="vehicleLength"
                      name="vehicleLength"
                      placeholder="Enter vehicle's Length"
                      value="1360"
                    />
                    &nbsp;
                    <span
                      class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                      ><span class="input-group-text">Width</span></span
                    >
                    <input
                      class="form-control"
                      type="text"
                      id="vehicleWidth"
                      name="vehicleWidth"
                      placeholder="Enter vehicle's Width"
                      value="246"
                    />
                    &nbsp;
                    <span
                      class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                      ><span class="input-group-text">Height</span></span
                    >
                    <input
                      class="form-control"
                      type="text"
                      id="vehicleHeight"
                      name="vehicleHeight"
                      placeholder="Enter vehicle's Heigth"
                      value="280"
                    />
                  </div>
                  <div>
                    <small class="form-text text-muted"
                      >Please enter dimentions in centimeter.</small
                    >
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <label for="vehicleIcons" class="col-sm-2 col-form-label"
                  >Images</label
                >
                <div class="col-sm-10">
                  <input type="file" id="vehicleIcons" name="icons" multiple />
                </div>
              </div>

              <div class="form-group row">
                <button
                  id="btnRates"
                  type="button"
                  class="col-sm-2 col-form-label btn btn-outline-secondary btn-sm waves-effect"
                >
                  Add Rates
                </button>
              </div>

              <div
                style="display: none"
                class="form-group row"
                id="div_rate"
                name="rates[]"
              >
                <label class="col-sm-2 col-form-label">Rates</label>
                <div class="col-sm-10 rates_input_div">
                  <div>
                    <div
                      class="input-group bootstrap-touchspin bootstrap-touchspin-injected"
                    >
                      <span
                        class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                        ><span class="input-group-text">Start</span></span
                      >
                      <input
                        id="kmFrom"
                        class="form-control km-from"
                        type="text"
                        name="kmFrom"
                        placeholder="Enter Kilometer"
                      />
                      &nbsp;
                      <span
                        class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                        ><span class="input-group-text">End</span></span
                      >
                      <input
                        id="kmTo"
                        class="form-control km-to"
                        type="text"
                        name="kmTo"
                        placeholder="Enter Kilometers"
                      />
                      &nbsp;
                      <span
                        class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
                        ><span class="input-group-text">Price</span></span
                      >
                      <input
                        id="price"
                        class="form-control"
                        type="text"
                        name="price"
                        placeholder="Enter price"
                      />
                      &nbsp;
                    </div>
                    <br />
                    <div>
                      <label class="col-sm-0">Onwards</label>
                      <input
                        type="hidden"
                        id="chbPriceHidden"
                        value="unchecked"
                        class="chb_rate_default"
                      />
                      <input
                        type="checkbox"
                        id="chbPrice"
                        value="checked"
                        class="chb_rate_default"
                      />
                    </div>
                  </div>
                </div>

                <button
                  id="btnAddRate"
                  type="button"
                  class="btn btn-success btn-sm waves-effect add_more_rate"
                >
                  Add
                </button>
              </div>

              <button
                type="submit"
                class="btn btn-primary btn-sm btn-block waves-effect"
              >
                Add Vehicle
              </button>

              <button
                id="btnCancel"
                name="btnCancel"
                type="button"
                class="btn btn-danger btn-sm btn-block waves-effect"
                onclick="location.href='/dashboard'"
              >
                Cancel
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- contentFor('FooterJs') %> <%- contentFor('BottomJs') %>
<script>
  $(function () {
    $("#btnRates").click(function () {
      $("#div_rate").toggle();
    });

    $(document).on("click", ".add_more_rate", function (e) {
      e.preventDefault();
      let cnt = $(".rates").length;
      let id = "newRate_" + cnt;

      let endValue = $(".rates_input_div")
        .find(".km-to:last")
        .attr("name", "kmTo")
        .val();
      let convertEndValue = parseInt(endValue, 10);
      let newValue = convertEndValue + 1;

      var html =
        `<div class="rates" id=` +
        id +
        `>
          <br />
          <div
            class="input-group bootstrap-touchspin bootstrap-touchspin-injected"
          >
            <span
              class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
              ><span class="input-group-text">Start</span></span
            >
            <input
              id="kmFrom_` +
        id +
        `"
              class="form-control km-from"
              type="text"
              name="kmFrom"
              placeholder="Enter Kilometer"
            />
            &nbsp;
            <span
              class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
              ><span class="input-group-text">End</span></span
            >
            <input
              id="kmTo_` +
        id +
        `"
              class="form-control km-to"
              type="text"
              name="kmTo"
              placeholder="Enter Kilometers"
              
            />
            &nbsp;
            <span
              class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"
              ><span class="input-group-text">Price</span></span
            >
            <input
              id="price_` +
        id +
        `"
              class="form-control"
              type="text"
              name="price"
              placeholder="Enter price"
            />
            &nbsp;
          </div>
          <br/>
          <div>
            <label class="col-sm-0">Onwards</label>
            <input type="hidden" id="chbPriceHidden_` +
        id +
        `" value="unchecked" class="chb_rate" />
            <input type="checkbox" id="chbPrice_` +
        id +
        `" value="checked" class="chb_rate" />
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            &nbsp;
            <button id="btnRemoveRate_` +
        id +
        `" type="button" class="btn btn-danger btn-sm waves-effect remove_rate">
              Remove
            </button>
          </div>
        </div>
      </div>`;
      $(".rates_input_div").append(html);

      $(".rates").find(".km-from").attr("readonly", true);
      $(".rates")
        .find("#kmFrom_" + id)
        .val(newValue);
    });

    $(document).on("click", ".remove_rate", function () {
      let id = $(this).attr("id");
      let split_id = id.split("_");
      let removeId = "#newRate_" + split_id[2];
      $(removeId).remove();
    });

    $(document).on("click", ".chb_rate_default", function () {
      if ($(this).is(":checked") == true) {
        $("#kmTo").val("-1");
        $("#btnAddRate").attr("disabled", true);
        $("#kmTo").attr("readonly", true);
      } else {
        $("#kmTo").val("");
        $("#btnAddRate").attr("disabled", false);
        $("#kmTo").attr("readonly", false);
      }
    });

    $(document).on("click", ".chb_rate", function () {
      let id = $(this).attr("id");
      let slice_id = id.slice(9);

      if ($(this).is(":checked") == true) {
        $("#kmTo_" + slice_id).val("-1");
        $("#btnAddRate").attr("disabled", true);
        $("#btnRemoveRate_" + slice_id).attr("disabled", true);
        $("#kmTo_" + slice_id).attr("readonly", true);
      } else {
        $("#kmTo_" + slice_id).val("");
        $("#btnAddRate").attr("disabled", false);
        $("#btnRemoveRate_" + slice_id).attr("disabled", false);
        $("#kmTo_" + slice_id).attr("readonly", false);
      }
    });
  });
</script>
